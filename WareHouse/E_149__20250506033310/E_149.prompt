Read integers N and M from standard input, representing the number of ordinary guests and the number of handshakes, respectively. Read an array A of length N, where each element A[i] represents the power of the i-th ordinary guest. Initialize a variable 'happiness' to 0 to keep track of the total happiness after handshakes. Create a set 'handshake_set' to store unique pairs of handshakes (x, y) to ensure no handshake is repeated. Implement a loop to perform M handshakes:\n   - For each handshake, select two guests x and y (where 1 ≤ x, y ≤ N).\n   - Check if the pair (x, y) is not already in 'handshake_set'.\n   - If unique, add (x, y) to 'handshake_set' and update 'happiness' by adding A[x-1] + A[y-1] (adjusting for 0-based indexing). If the number of unique handshakes reaches M, break the loop early to avoid unnecessary iterations. Print the final value of 'happiness' as the output.\n\nThis structure ensures that the requirements are clear and the implementation steps are logically organized to achieve the desired outcome.